<body>
<head>
	<title> Bienvenido Mau</title>
	<!--script src="js/jquery-3.3.1.min.js"></script-->
	<!--script src="js/geneticAlgorithm.js"></script-->
	<script src="js/math.min"></script>
	
	<script>
		$(function(){
			var tableOfCharacters = ['0','1','2','3','4','5','6','7','8','9','+','-','*','/','l','p','.'];
			var variablesRunsSet = {
					0:{x:1, y:3.1416},
					1:{x:2, y:3.1416}
				};
			/*var randomize = function(){
				var genes = "";
				var amount = Math.floor(Math.random() * 10)+1;
				for(var i =0; i<amount;i++){
					var type = Math.floor(Math.random() * tableOfCharacters.length); // from 0 to latest character
					if(tableOfCharacters[type] == 'l'){
						genes = genes+"l("+randomize()+")";
					}else if(tableOfCharacters[type] == 'p'){
						genes = genes+"p("+randomize()+","+randomize()+")";
					}else{
						genes = genes+tableOfCharacters[type];
					}
				}
				return genes;	
			};*/
			var randomize = function(limit = 10){
				var possibleNodes;
				if(limit <= 0){
					possibleNodes = ["number"];
				}else{
					possibleNodes = ["+","-","*","/","pow","log", "par", "sin", "cos", "tan", "asin", "acos", "atan", "number"];
				}
				var type = Math.floor(Math.random() * possibleNodes.length); // from 0 to latest character
				var genes = "";
				//type = 1;
				var operator = possibleNodes[type];
				switch(operator){
					case "+":
					case "-":
					case "*":
					case "/":
						var op1 = randomize(limit -1);
						var op2 = randomize(limit -1);
						genes = op1+operator+op2;
						break;
					case "pow":
					case "log":
						var op1 = randomize(limit -1);
						var op2 = randomize(limit -1);
						genes = operator+"("+op1+","+op2+")";
						break;
					case "par":
						var op1 = randomize(limit -1);
						genes = "(" + op1 + ")";
						break;
					case "sin":
					case "cos":
					case "tan":
					case "asin":
					case "acos":
					case "atan":
						var op1 = randomize(limit -1);
						genes = operator +"(" + op1 + ")";
						break; 
					case "number":

						var genes = math.random(1000);
						break;
				}
				
				return genes;
				
			}
			var fitness = function(gene){
				var totalDifference = 0;
				for(variablesRunIndex in variablesRunsSet){
					var variablesRun = variablesRunsSet[variablesRunIndex];
					var realY = variablesRun.y;
					for(variableName in variablesRun){
						value = variablesRun[variableName];
						eval("var "+variableName+" = '"+value+"';");
					}
					var y = null;
					
					    console.log(gene + "=");
					    var temp = eval("y="+gene);
					    var difference = Math.pow(temp-realY,2);
					    totalDifference+=difference;
					
					
				}
				return totalDifference;
			}
			var validator = function(code, variablesRunsSet){
					for(variablesRunIndex in variablesRunsSet){
						variablesRun = variablesRunsSet[variablesRunIndex];
						for(variableName in variablesRun){
							value = variablesRun[variableName];
							eval("var "+variableName+" = '"+value+"';");
						}
						var y = null;
						try {
						    console.log(code + "=");
						    var temp = eval("y="+code);
						    console.log(temp);
						} catch (e) {
						    return false;
						}
					}
					return true;
			}
			var geneticAlgorith = ga({
				validator: validator},
				randomize: randomize,
				generationsCount:100,
				populationCount:20,
				variablesRunsSet:variablesRunsSet,
				fitness: fitness
			});
			geneticAlgorith.execute();
		});
	</script>
</head>
<body>
	Hola mundo
</body>
</html>
